name: FourM Scraping Job

on:
  schedule:
    - cron: "0 0 * * *"  # 毎日0時に実行
  workflow_dispatch:  # 手動トリガー用

jobs:
  scraping-job:
    runs-on: ubuntu-latest

    steps:
    - name: チェックアウトリポジトリ
      uses: actions/checkout@v3

    - name: Pythonのセットアップ
      uses: actions/setup-python@v4
      with:
        python-version: 3.9

    - name: 必要なライブラリをインストール
      run: |
        pip install google-auth google-auth-httplib2 google-auth-oauthlib google-api-python-client pandas openpyxl

    - name: 認証情報を設定
      env:
        GOOGLE_APPLICATION_CREDENTIALS_JSON: ${{ secrets.GOOGLE_APPLICATION_CREDENTIALS }}
      run: |
        echo "${GOOGLE_APPLICATION_CREDENTIALS_JSON}" > credentials.json
        export GOOGLE_APPLICATION_CREDENTIALS=credentials.json

    - name: Pythonスクリプトを実行
      run: python FourM_scraping.py
